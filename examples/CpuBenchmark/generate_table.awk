#!/usr/bin/gawk -f
#
# Usage: generate_table.sh < ${board}.out
#
# Takes the file generated by collect.sh and generates an ASCII
# table that can be inserted into the README.md.

BEGIN {
    labels[0] = "crc16ccitt_bit";
    labels[1] = "crc16ccitt_nibble";
    labels[2] = "crc16ccitt_byte";
    labels[3] = "crc32_bit";
    labels[4] = "crc32_nibble";
    labels[5] = "crc32_byte";
    num_records = 0
}
!/^END/ {
    algorithm = NR - 1
    u[algorithm]["name"] = $1
    u[algorithm]["micros"] = $6
    num_records++
}
END {
    printf("+-----------------------------------------------+\n")
    printf("| CRC algorithm                   |  micros/kiB |\n")
    printf("|---------------------------------+-------------|\n")
    for (i = 0; i < num_records; i++) {
        printf("| %-31s | %11d |\n", labels[i], u[i]["micros"])
    }
    printf("+---------------------------------+-------------+\n")
}
